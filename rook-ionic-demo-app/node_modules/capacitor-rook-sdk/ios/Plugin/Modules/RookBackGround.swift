//
//  RookBackGround.swift
//  Plugin
//
//  Created by Francisco Guerrero Escamilla on 04/05/24.
//  Copyright Â© 2024 Max Lynch. All rights reserved.
//

import Foundation
import RookSDK
import Capacitor

@objc public class RookBackGround: NSObject {

  private let backgroundManager: RookBackGroundSync = RookBackGroundSync.shared

  @objc public func enableBackGroundUpdates(call: CAPPluginCall) {
    backgroundManager.enableBackGroundForSummaries()
    call.resolve(["result": true])
  }

  @objc public func disableBackGroundUpdates(call: CAPPluginCall) {
    backgroundManager.disableBackGroundForSummaries()
    backgroundManager.disableBackGroundForEvents()
    backgroundManager.disableBackGroundForActivityEvents { result in
      switch result {
      case .success(let result):
        call.resolve(["result": result])
      case .failure(let error):
        call.reject(error.localizedDescription)
      }
    }
  }
}
